(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("alloyfinger"),require("css3transform")):"function"==typeof define&&define.amd?define("PreviewImageCss",["alloyfinger","css3transform"],t):"object"==typeof exports?exports.PreviewImageCss=t(require("alloyfinger"),require("css3transform")):e.PreviewImageCss=t(e.alloyfinger,e.css3transform)})(this,function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,n){"use strict";function i(e,t){return e/t>=1?1:-1}function o(e,t,n,i,a){return o[a+""].apply(null,arguments)}function a(e,t,n,i){return(t-e)*i+e+n}function r(e,t,n){var i=e*n;return i<=t?{min:(t-i)/2,max:(t-i)/2}:{min:t-i,max:0}}function l(e,t,n,i,o){var l=a(t/2,n,i,o),u=r(e,t,o),s=!1;return u.min===u.max?s=0:u.min>l?s=u.min-l+i:u.max<l&&(s=u.max-l+i),s}function u(e,t,n,i,o,a){var r=t-e,l=n-e,u=(l-0)*a+0,s=(l-r)*a+r,c=s-u,f=s+e,d=i*a,m=0,h=o-d;return d<=o?c=0:(f>m&&(c=m-e-u),f<h&&(c=h-e-u)),c}Object.defineProperty(t,"__esModule",{value:!0}),o[1]=function(e,t,n,i){return{w:e,h:i*e/n}},o[-1]=function(e,t,n,i){return{h:t,w:n*t/i}},t.judgeShape=i,t.transformWH=o,t.calculateOffset=u,t.calculatePoint=a,t.calculagteRange=r,t.checkPlace=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(){for(var e=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),i=Math.max(0,16-(n-e)),o=window.setTimeout(function(){t(n+i)},i);return e=n+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var i=function e(t,n,i,o,a,r,l){var u=t[n],s=i-u,c=new Date,f=this,d=a||function(e){return e};this.tickID=null,function e(){var a=new Date-c;if(a>=o)return t[n]=i,l&&l(i),r&&r(i),cancelAnimationFrame(f.tickID),void(f.toTick=null);t[n]=s*d(a/o)+u,f.tickID=requestAnimationFrame(e),l&&l(t[n])}(),e.List.push(this)};i.List=[],i.stopAll=function(){for(var e=0,t=i.List.length;e<t;e++)cancelAnimationFrame(i.List[e].tickID);i.List.length=0},i.stop=function(e){cancelAnimationFrame(e.tickID)},t.default=i},function(e,t,n){"use strict";function i(e){return"object"===("undefined"==typeof HTMLElement?"undefined":u(HTMLElement))?e instanceof HTMLElement:e&&"object"===(void 0===e?"undefined":u(e))&&1===e.nodeType&&"string"==typeof e.nodeName}function o(e,t){if("object"===(void 0===t?"undefined":u(t)))for(var n in t)e.style[n]=t[n]}function a(e){var t=document.createElement("img");return t.addEventListener("load",function(e){a.AFTER_HOOK&&a.AFTER_HOOK(null,t),a.AFTER_HOOK=null}),t.addEventListener("error",function(e){var n=new Error("图片加载失败");a.AFTER_HOOK&&a.AFTER_HOOK(n,t),a.AFTER_HOOK=null}),t.src=e,a}function r(e,t,n){var a=document.createElement(e);return t&&o(a,t),n&&i(n)&&a.appendChild(n),a}function l(e){return Math.sqrt(1-Math.pow(e-1,2))}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};a.after=function(e){a.AFTER_HOOK=e},t.isDom=i,t.setStyle=o,t.pullImage=a,t.createElement=r,t.ease=l},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(3),u=o(l),s=n(4),c=o(s),f=n(2),d=i(f),m=n(1),h=o(m),p=n(0),w=i(p),g={imageSrc:"",doubleZoom:2,maxZoom:4,minZoom:1,softX:!0,softY:!0},v=function(){function e(t,n){var i=this;a(this,e),d.isDom(t)&&(this.options=n||{},this.context=t,this.conBox=t.getBoundingClientRect(),d.setStyle(this.context,{position:"relative"}),d.pullImage(this.options.imageSrc).after(function(e,t){e||(i.element=t,i.callStart&&(i.start(),i.callStart=!1))}))}return r(e,[{key:"start",value:function(){if(!this.element)return this.callStart=!0;var e=w.judgeShape(this.element.width,this.element.height),t=w.transformWH(this.context.clientWidth,this.context.clientHeight,this.element.width,this.element.height,e),n=t.w,i=t.h,o=e===-1?0:window.innerHeight/2-i/2,a=1===e?0:window.innerWidth/2-n/2;d.setStyle(this.element,{position:"absolute",width:n+"px",height:i+"px",top:o+"px",left:a+"px"}),this.elBox=this.element.getBoundingClientRect(),this.leftPx=a,this.topPx=o,(0,c.default)(this.element),this.bind()}},{key:"bind",value:function(){var e=this.element,t=this.options.minZoom,n=this.options.maxZoom,i=this.elBox,o=this.conBox,a=this,r=this.leftPx,l=this.topPx,s=d.ease,c=1,f=!1;this.gesture=new u.default(this.context,{multipointStart:function(){h.default.stopAll(),c=e.scaleX},pinch:function(t){e.scaleX=e.scaleY=c*t.scale},multipointEnd:function(){e.scaleX<t&&(new h.default(e,"scaleX",t,500,s),new h.default(e,"scaleY",t,500,s)),e.scaleX>n&&(new h.default(e,"scaleX",n,500,s),new h.default(e,"scaleY",n,500,s))},pressMove:function(t){h.default.stopAll(),f=!0;var n=a.options.softX,u=a.options.softY;if(n)e.translateX+=t.deltaX;else{w.checkPlace(i.width,o.width,r,e.translateX+t.deltaX,e.scaleX)===!1&&(e.translateX+=t.deltaX)}if(u)e.translateY+=t.deltaY;else{w.checkPlace(i.height,o.height,l,e.translateY,e.scaleY)===!1&&(e.translateY+=t.deltaY)}t.preventDefault()},touchEnd:function(){if(f){var t=w.checkPlace(i.height,o.height,l,e.translateY,e.scaleY),n=w.checkPlace(i.width,o.width,r,e.translateX,e.scaleX);t!==!1&&new h.default(e,"translateY",t,400,s),n!==!1&&new h.default(e,"translateX",n,400,s)}f=!1},doubleTap:function(n){h.default.stopAll();var u=a.options.doubleZoom,c=(t+u)/2,f=200;if(e.scaleX>c)new h.default(e,"scaleX",t,f,s),new h.default(e,"scaleY",t,f,s),new h.default(e,"translateX",0,f,s),new h.default(e,"translateY",0,f,s);else{var d=o.width/2,m=o.height/2,p=[n.changedTouches[0].pageX,n.changedTouches[0].pageY],g=p[0],v=p[1],y=w.calculateOffset(d,g,r,i.width,o.width,u),x=w.calculateOffset(m,v,l,i.height,o.height,u);new h.default(e,"scaleX",u,f,s),new h.default(e,"scaleY",u,f,s),new h.default(e,"translateX",y,f,s),new h.default(e,"translateY",x,f,s)}}})}},{key:"unbind",value:function(){this.gesture=this.gesture.destroy()}},{key:"options",get:function(){return this._options},set:function(e){this._options=Object.assign(g,e)}},{key:"element",get:function(){return this._element},set:function(e){this._element||(this._element=e,this.context.appendChild(this.element))}}]),e}();t.default=v}])});